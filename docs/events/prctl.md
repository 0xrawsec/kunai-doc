---
sidebar_position: 7
---

# Prctl

A `prctl` event is generated when a process makes a call to the [`prctl`](https://man7.org/linux/man-pages/man2/prctl.2.html) **syscall**. As you can
read in the man page, this syscall can be used to achieve a wide range of
operations. Some of them might be considered as malicious, depending on 
the context.

:::tip
This example shows a prctl call to rename the current task. As a consequence,
we can observe that the **new task name** in `.info.task.name`:
* has nothing to do with the executable name (not always bad)
* contains `/` which is pretty uncommon

**NB:** this event has been generated by a **BPFDoor** malware sample 
:::

```json
{
  "data": {
    "exe": "/dev/shm/kdmtmpflush",
    "command_line": "/dev/shm/kdmtmpflush --init",
    // first argument to prctl
    "option": "PR_SET_NAME",
    // arg[2-5]:Â others arguments to prctl, their meaning depends on option
    "arg2": "0x605368",
    "arg3": "0x0",
    "arg4": "0x8",
    "arg5": "0x3",
    // whether the syscall was successful or not
    "success": true
  },
  "info": {
    ...
    "event": {
        ...
        "id": 7,
        "name": "prctl",
        ...
    },
    ...
    "task": {
      // new task name
      "name": "/usr/sbin/conso",
      "pid": 3126,
      "tgid": 3126,
      "guuid": "072485a3-5236-0000-fd99-a119360c0000",
      "uid": 0,
      "gid": 0,
      "namespaces": {
        "mnt": 4026531840
      }
    },
    ...
}

```